


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Migration Guide 2.0.x to 2.1.x &mdash; Akka Documentation</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/base.css" type="text/css" />
    <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Exo:300,400,600,700" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/toc.js"></script>
    <script type="text/javascript" src="../_static/prettify.js"></script>
    <script type="text/javascript" src="../_static/highlightCode.js"></script>
    <script type="text/javascript" src="../_static/effects.core.js"></script>
    <script type="text/javascript" src="../_static/effects.highlight.js"></script>
    <script type="text/javascript" src="../_static/scrollTo.js"></script>
    <script type="text/javascript" src="../_static/contentsFix.js"></script>
    <script type="text/javascript" src="../_static/ga.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Akka Documentation" href="../index.html" />
    <link rel="up" title="Migration Guides" href="migration-guides.html" />
    <link rel="next" title="Release Notes" href="release-notes.html" />
    <link rel="prev" title="Migration Guide 1.3.x to 2.0.x" href="migration-guide-1.3.x-2.0.x.html" />

  </head>
  <body>
  <div class="navbar">
    <div class="navbar-inner">
      <div class="container">
        <div class="navbar-logo">
          <a href="http://akka.io"><img src="../_static/logo-small.png" /></a>
        </div>    
        <ul class="nav">
          <li><a href="http://akka.io/docs">Documentation</a></li>
          <li><a href="http://akka.io/faq">FAQ</a></li>
          <li><a href="http://typesafe.com/stack/downloads/akka">Download</a></li>
          <li><a href="http://groups.google.com/group/akka-user">Mailing List</a></li>
          <li><a href="http://github.com/akka/akka">Code</a></li>           
          <li><a href="http://typesafe.com/products/typesafe-subscription">Commercial Support</a></li>
        </ul>
      </div>
    </div>
  </div>
  <div class="main">
    <div class="container">
      <div class="page-title">Migration Guide 2.0.x to 2.1.x</div>
      <div class="pdf-link"><a href="../Akka.pdf"><img src="../_static/pdf-icon.png" style="height: 40px;" /></a></div>
    </div>
    <div class="main-container">
      <div class="container">
        <div class="row">
          <div class="span12">
            <ul class="breadcrumb">           
              <li>
                 <span class="divider">|</span> <a href="release-notes.html">Release Notes</a> <span class="divider">»</span>
              </li>
              <li>
                <a href="../index.html">Contents</a>
              </li>
              <li>
                <span class="divider">«</span> <a href="migration-guide-1.3.x-2.0.x.html">Migration Guide 1.3.x to 2.0.x</a> <span class="divider">|</span>
              </li>
              <li>
                Version 2.1.2
              </li>
            </ul>
          </div>
        </div>
        <div class="row"><div class="span9">
            
  <div class="section" id="migration-guide-2-0-x-to-2-1-x">
<span id="migration-2-1"></span><h1>Migration Guide 2.0.x to 2.1.x</h1>
<p>Some parts of the 2.0 API have changed in the Akka 2.1 release. This guide lists the the changes and
explains what you will need to do to upgrade your program to work with Akka 2.1.</p>
<p>Migrating from Akka 2.0.x to Akka 2.1.x is relatively straightforward. In Akka 2.1 the API has
undergone some basic housekeeping, for example some package names have changed, but otherwise usage
is largely unchanged. User programs will generally only need simple, mechanical changes in order to
work with Akka 2.1.</p>
<p>If you are migrating from Akka 1.3.x you will need to follow the instructions for
<a class="reference external" href="http://doc.akka.io/docs/akka/2.0.3/project/migration-guide-1.3.x-2.0.x.html">migrating from Akka 1.3.x to 2.0.x</a>
before following the instructions in this guide.</p>
<div class="section" id="scala-version">
<h2>Scala Version</h2>
<p>Akka 2.1 uses a new version of Scala.
Change your project build and dependencies to Scala version <tt class="docutils literal"><span class="pre">2.10.1</span></tt>.</p>
</div>
<div class="section" id="config-dependency">
<h2>Config Dependency</h2>
<p>Akka's configuration system has graduated from Akka to become the <a class="reference external" href="https://github.com/typesafehub/config">Typesafe config</a> project. The configuration system was previously embedded
within <tt class="docutils literal"><span class="pre">akka-actor.jar</span></tt>, now it is specified as a dependency of <tt class="docutils literal"><span class="pre">akka-actor.jar</span></tt>.</p>
<p>If your are using a build tool with automatic dependency resolution, such as sbt or Maven, then you
will not notice a difference. Otherwise you will need to ensure that
<a class="reference external" href="http://mirrors.ibiblio.org/maven2/com/typesafe/config/1.0.0/">config-1.0.0.jar</a>
is present on your classpath.</p>
</div>
<div class="section" id="pieces-moved-to-scala-standard-library">
<h2>Pieces Moved to Scala Standard Library</h2>
<p>Change the following import statements.</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Search</th>
<th class="head">Replace with</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">akka.dispatch.Await</span></tt></td>
<td><tt class="docutils literal"><span class="pre">scala.concurrent.Await</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">akka.dispatch.Future</span></tt></td>
<td><tt class="docutils literal"><span class="pre">scala.concurrent.Future</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">akka.dispatch.Promise</span></tt></td>
<td><tt class="docutils literal"><span class="pre">scala.concurrent.Promise</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">akka.dispatch.ExecutionContext</span></tt></td>
<td><tt class="docutils literal"><span class="pre">scala.concurrent.ExecutionContext</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">akka.util.Duration</span></tt></td>
<td><tt class="docutils literal"><span class="pre">scala.concurrent.duration.Duration</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">akka.util.duration</span></tt></td>
<td><tt class="docutils literal"><span class="pre">scala.concurrent.duration</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">akka.util.Deadline</span></tt></td>
<td><tt class="docutils literal"><span class="pre">scala.concurrent.duration.Deadline</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">akka.util.NonFatal</span></tt></td>
<td><tt class="docutils literal"><span class="pre">scala.util.control.NonFatal</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">akka.japi.Util.manifest</span></tt></td>
<td><tt class="docutils literal"><span class="pre">akka.japi.Util.classTag</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="scheduler-dispatcher">
<h2>Scheduler Dispatcher</h2>
<p>The <tt class="docutils literal"><span class="pre">ExecutionContext</span></tt> to use for running scheduled tasks must now be specified.
You can use an Akka <tt class="docutils literal"><span class="pre">Dispatcher</span></tt> for this purpose.</p>
<p>Scala:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">context.dispatcher</span> <span class="c1">// Use this Actors&#39; Dispatcher as ExecutionContext</span>
<span class="n">context</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">scheduleOnce</span><span class="o">(</span><span class="mi">10</span> <span class="n">seconds</span><span class="o">,</span> <span class="n">self</span><span class="o">,</span> <span class="nc">Reconnect</span><span class="o">)</span>

<span class="k">import</span> <span class="nn">system.dispatcher</span> <span class="c1">// Use ActorSystem&#39;s default Dispatcher as ExecutionContext</span>
<span class="n">system</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">scheduleOnce</span><span class="o">(</span><span class="mi">50</span> <span class="n">milliseconds</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">testActor</span> <span class="o">!</span> <span class="nc">System</span><span class="o">.</span><span class="n">currentTimeMillis</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Java:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="c1">// Use this Actors&#39; Dispatcher as ExecutionContext</span>
<span class="n">getContext</span><span class="o">().</span><span class="n">system</span><span class="o">().</span><span class="n">scheduler</span><span class="o">().</span><span class="n">scheduleOnce</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="n">create</span><span class="o">(</span>
  <span class="mi">10</span><span class="o">,</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="nc">SECONDS</span><span class="o">),</span> <span class="n">getSelf</span><span class="o">(),</span> <span class="k">new</span> <span class="nc">Reconnect</span><span class="o">(),</span>
  <span class="n">getContext</span><span class="o">().</span><span class="n">getDispatcher</span><span class="o">());</span>

<span class="c1">// Use ActorSystem&#39;s default Dispatcher as ExecutionContext</span>
<span class="n">system</span><span class="o">.</span><span class="n">scheduler</span><span class="o">().</span><span class="n">scheduleOnce</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="n">create</span><span class="o">(</span><span class="mi">50</span><span class="o">,</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="nc">MILLISECONDS</span><span class="o">),</span>
  <span class="k">new</span> <span class="nc">Runnable</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="n">public</span> <span class="n">void</span> <span class="n">run</span><span class="o">()</span> <span class="o">{</span>
      <span class="n">testActor</span><span class="o">.</span><span class="n">tell</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="n">currentTimeMillis</span><span class="o">());</span>
    <span class="o">}</span>
  <span class="o">},</span> <span class="n">system</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">());</span>
</pre></div>
</div>
</div>
<div class="section" id="api-changes-to-future-scala">
<h2>API Changes to Future - Scala</h2>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">def</span> <span class="n">square</span><span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Promise</span> <span class="n">successful</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">def</span> <span class="n">square</span><span class="o">(</span><span class="n">i</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Future</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Future</span> <span class="n">successful</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span>
</pre></div>
</div>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">failedFilter</span> <span class="k">=</span> <span class="n">future1</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="k">_</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="o">).</span><span class="n">recover</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">m</span><span class="k">:</span> <span class="kt">MatchError</span> <span class="o">=&gt;</span> <span class="c1">//When filter fails, it will have a MatchError</span>
<span class="o">}</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">failedFilter</span> <span class="k">=</span> <span class="n">future1</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="k">_</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="o">).</span><span class="n">recover</span> <span class="o">{</span>
  <span class="c1">// When filter fails, it will have a java.util.NoSuchElementException</span>
  <span class="k">case</span> <span class="n">m</span><span class="k">:</span> <span class="kt">NoSuchElementException</span> <span class="o">=&gt;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>A <tt class="docutils literal"><span class="pre">Promise</span></tt> is no longer also a <tt class="docutils literal"><span class="pre">Future</span></tt>, obtain the reference to its Future by calling <tt class="docutils literal"><span class="pre">promise.future</span></tt>.</p>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Await</span><span class="o">.</span><span class="n">result</span><span class="o">(</span><span class="n">promise</span><span class="o">,</span> <span class="n">duration</span><span class="o">)</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Await</span><span class="o">.</span><span class="n">result</span><span class="o">(</span><span class="n">promise</span><span class="o">.</span><span class="n">future</span><span class="o">,</span> <span class="n">duration</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="api-changes-to-future-java">
<h2>API Changes to Future - Java</h2>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">ExecutorService</span> <span class="n">yourExecutorServiceGoesHere</span> <span class="k">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="n">newSingleThreadExecutor</span><span class="o">();</span>
<span class="nc">ExecutionContextExecutorService</span> <span class="n">ec</span> <span class="k">=</span>
  <span class="nc">ExecutionContexts</span><span class="o">.</span><span class="n">fromExecutorService</span><span class="o">(</span><span class="n">yourExecutorServiceGoesHere</span><span class="o">);</span>

<span class="c1">// Use ec with your Futures</span>
<span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">f1</span> <span class="k">=</span> <span class="nc">Futures</span><span class="o">.</span><span class="n">successful</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="n">ec</span><span class="o">);</span>

<span class="c1">// Then you shut the ec down somewhere at the end of your application.</span>
<span class="n">ec</span><span class="o">.</span><span class="n">shutdown</span><span class="o">();</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">ExecutorService</span> <span class="n">yourExecutorServiceGoesHere</span> <span class="k">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="n">newSingleThreadExecutor</span><span class="o">();</span>
<span class="nc">ExecutionContext</span> <span class="n">ec</span> <span class="k">=</span>
  <span class="nc">ExecutionContexts</span><span class="o">.</span><span class="n">fromExecutorService</span><span class="o">(</span><span class="n">yourExecutorServiceGoesHere</span><span class="o">);</span>

<span class="c1">//No need to pass the ExecutionContext here</span>
<span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">f1</span> <span class="k">=</span> <span class="nc">Futures</span><span class="o">.</span><span class="n">successful</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">);</span>

<span class="c1">// Then you shut the ExecutorService down somewhere at the end of your application.</span>
<span class="n">yourExecutorServiceGoesHere</span><span class="o">.</span><span class="n">shutdown</span><span class="o">();</span>
</pre></div>
</div>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">f1</span> <span class="k">=</span> <span class="n">future</span><span class="o">(</span><span class="k">new</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="n">public</span> <span class="nc">String</span> <span class="n">call</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;Hello&quot;</span> <span class="o">+</span> <span class="s">&quot;World&quot;</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">},</span> <span class="n">system</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">());</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">final</span> <span class="nc">ExecutionContext</span> <span class="n">ec</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">();</span>

<span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">f1</span> <span class="k">=</span> <span class="n">future</span><span class="o">(</span><span class="k">new</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="n">public</span> <span class="nc">String</span> <span class="n">call</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;Hello&quot;</span> <span class="o">+</span> <span class="s">&quot;World&quot;</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">},</span> <span class="n">ec</span><span class="o">);</span>
</pre></div>
</div>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">future1</span> <span class="k">=</span> <span class="nc">Futures</span><span class="o">.</span><span class="n">successful</span><span class="o">(</span><span class="s">&quot;value&quot;</span><span class="o">,</span> <span class="n">system</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">()).</span><span class="n">andThen</span><span class="o">(</span>
  <span class="k">new</span> <span class="nc">OnComplete</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="n">public</span> <span class="n">void</span> <span class="n">onComplete</span><span class="o">(</span><span class="nc">Throwable</span> <span class="n">failure</span><span class="o">,</span> <span class="nc">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">failure</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
          <span class="n">sendToIssueTracker</span><span class="o">(</span><span class="n">failure</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}).</span><span class="n">andThen</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnComplete</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="n">public</span> <span class="n">void</span> <span class="n">onComplete</span><span class="o">(</span><span class="nc">Throwable</span> <span class="n">failure</span><span class="o">,</span> <span class="nc">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
      <span class="n">sendToTheInternetz</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">final</span> <span class="nc">ExecutionContext</span> <span class="n">ec</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">();</span>
<span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">future1</span> <span class="k">=</span> <span class="nc">Futures</span><span class="o">.</span><span class="n">successful</span><span class="o">(</span><span class="s">&quot;value&quot;</span><span class="o">).</span><span class="n">andThen</span><span class="o">(</span>
  <span class="k">new</span> <span class="nc">OnComplete</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="n">public</span> <span class="n">void</span> <span class="n">onComplete</span><span class="o">(</span><span class="nc">Throwable</span> <span class="n">failure</span><span class="o">,</span> <span class="nc">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">failure</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
            <span class="n">sendToIssueTracker</span><span class="o">(</span><span class="n">failure</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">},</span> <span class="n">ec</span><span class="o">).</span><span class="n">andThen</span><span class="o">(</span><span class="k">new</span> <span class="nc">OnComplete</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="n">public</span> <span class="n">void</span> <span class="n">onComplete</span><span class="o">(</span><span class="nc">Throwable</span> <span class="n">failure</span><span class="o">,</span> <span class="nc">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
      <span class="n">sendToTheInternetz</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">},</span> <span class="n">ec</span><span class="o">);</span>
</pre></div>
</div>
<p>A <tt class="docutils literal"><span class="pre">Promise</span></tt> is no longer also a <tt class="docutils literal"><span class="pre">Future</span></tt>, obtain the reference to its Future by calling <tt class="docutils literal"><span class="pre">promise.future()</span></tt>.</p>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Await</span><span class="o">.</span><span class="n">result</span><span class="o">(</span><span class="n">promise</span><span class="o">,</span> <span class="n">duration</span><span class="o">);</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Await</span><span class="o">.</span><span class="n">result</span><span class="o">(</span><span class="n">promise</span><span class="o">.</span><span class="n">future</span><span class="o">(),</span> <span class="n">duration</span><span class="o">);</span>
</pre></div>
</div>
</div>
<div class="section" id="api-changes-to-dynamicaccess">
<h2>API changes to DynamicAccess</h2>
<p>All methods with scala.Either[Throwable, X] have been changed to use scala.util.Try[X].</p>
<p>DynamicAccess.withErrorHandling has been removed since scala.util.Try now fulfills that role.</p>
</div>
<div class="section" id="api-changes-to-serialization">
<h2>API changes to Serialization</h2>
<p>All methods with scala.Either[Throwable, X] have been changed to use scala.util.Try[X].</p>
</div>
<div class="section" id="empty-props">
<h2>Empty Props</h2>
<p>v2.0 Scala:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">router2</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">().</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="n">routees</span> <span class="k">=</span> <span class="n">routees</span><span class="o">)))</span>
</pre></div>
</div>
<p>v2.1 Scala:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">router2</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">.</span><span class="n">empty</span><span class="o">.</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RoundRobinRouter</span><span class="o">(</span><span class="n">routees</span> <span class="k">=</span> <span class="n">routees</span><span class="o">)))</span>
</pre></div>
</div>
<p>v2.0 Java:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">ActorRef</span> <span class="n">router2</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="k">new</span> <span class="nc">Props</span><span class="o">().</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RoundRobinRouter</span><span class="o">.</span><span class="n">create</span><span class="o">(</span><span class="n">routees</span><span class="o">)));</span>
</pre></div>
</div>
<p>v2.1 Java:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">ActorRef</span> <span class="n">router2</span> <span class="k">=</span> <span class="n">system</span><span class="o">.</span><span class="n">actorOf</span><span class="o">(</span><span class="nc">Props</span><span class="o">.</span><span class="n">empty</span><span class="o">().</span><span class="n">withRouter</span><span class="o">(</span>
  <span class="nc">RoundRobinRouter</span><span class="o">.</span><span class="n">create</span><span class="o">(</span><span class="n">routees</span><span class="o">)));</span>
</pre></div>
</div>
</div>
<div class="section" id="props-function-based-creation">
<h2>Props: Function-based creation</h2>
<p>v2.0 Scala:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Props</span><span class="o">(</span><span class="n">context</span> <span class="k">=&gt;</span> <span class="o">{</span> <span class="k">case</span> <span class="n">someMessage</span> <span class="k">=&gt;</span> <span class="n">context</span><span class="o">.</span><span class="n">sender</span> <span class="o">!</span> <span class="n">someMessage</span> <span class="o">})</span>
</pre></div>
</div>
<p>v2.1 Scala:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="nc">Props</span><span class="o">(</span><span class="k">new</span> <span class="nc">Actor</span> <span class="o">{</span> <span class="k">def</span> <span class="n">receive</span> <span class="k">=</span> <span class="o">{</span> <span class="k">case</span> <span class="n">someMessage</span> <span class="k">=&gt;</span> <span class="n">sender</span> <span class="o">!</span> <span class="n">someMessage</span> <span class="o">}</span> <span class="o">})</span>
</pre></div>
</div>
</div>
<div class="section" id="failing-send">
<h2>Failing Send</h2>
<p>When failing to send to a remote actor or an actor with a bounded or durable mailbox the message will
now be silently delivered to <tt class="docutils literal"><span class="pre">ActorSystem.deadletters</span></tt> instead of throwing an exception.</p>
</div>
<div class="section" id="graceful-stop-exception">
<h2>Graceful Stop Exception</h2>
<p>If the target actor of <tt class="docutils literal"><span class="pre">akka.pattern.gracefulStop</span></tt> isn't terminated within the
timeout then the <tt class="docutils literal"><span class="pre">Future</span></tt> is completed with a failure of <tt class="docutils literal"><span class="pre">akka.pattern.AskTimeoutException</span></tt>.
In 2.0 it was <tt class="docutils literal"><span class="pre">akka.actor.ActorTimeoutException</span></tt>.</p>
</div>
<div class="section" id="getinstance-for-singletons-java">
<h2>getInstance for Singletons - Java</h2>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">static</span> <span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="nc">Actors</span><span class="o">.*;</span>

<span class="k">if</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="n">equals</span><span class="o">(</span><span class="s">&quot;done&quot;</span><span class="o">))</span> <span class="o">{</span>
  <span class="n">myActor</span><span class="o">.</span><span class="n">tell</span><span class="o">(</span><span class="n">poisonPill</span><span class="o">());</span>
<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">msg</span> <span class="o">==</span> <span class="nc">Actors</span><span class="o">.</span><span class="n">receiveTimeout</span><span class="o">())</span> <span class="o">{</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">import</span> <span class="nn">akka.actor.PoisonPill</span><span class="o">;</span>
<span class="k">import</span> <span class="nn">akka.actor.ReceiveTimeout</span><span class="o">;</span>

<span class="k">if</span> <span class="o">(</span><span class="n">msg</span><span class="o">.</span><span class="n">equals</span><span class="o">(</span><span class="s">&quot;done&quot;</span><span class="o">))</span> <span class="o">{</span>
  <span class="n">myActor</span><span class="o">.</span><span class="n">tell</span><span class="o">(</span><span class="nc">PoisonPill</span><span class="o">.</span><span class="n">getInstance</span><span class="o">());</span>
<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">msg</span> <span class="o">==</span> <span class="nc">ReceiveTimeout</span><span class="o">.</span><span class="n">getInstance</span><span class="o">())</span> <span class="o">{</span>
</pre></div>
</div>
</div>
<div class="section" id="testkit-probe-reply">
<h2>Testkit Probe Reply</h2>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">probe</span><span class="o">.</span><span class="n">sender</span> <span class="o">!</span> <span class="s">&quot;world&quot;</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">probe</span><span class="o">.</span><span class="n">reply</span><span class="o">(</span><span class="s">&quot;world&quot;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="log-remote-lifecycle-events">
<h2>log-remote-lifecycle-events</h2>
<p>The default value of akka.remote.log-remote-lifecycle-events has changed to <strong>on</strong>.
If you don't want these events in the log then you need to add this to your configuration:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">akka</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">log</span><span class="o">-</span><span class="n">remote</span><span class="o">-</span><span class="n">lifecycle</span><span class="o">-</span><span class="n">events</span> <span class="k">=</span> <span class="n">off</span>
</pre></div>
</div>
</div>
<div class="section" id="stash-poststop">
<h2>Stash postStop</h2>
<p>Both Actors and UntypedActors using <tt class="docutils literal"><span class="pre">Stash</span></tt> now override postStop to make sure that
stashed messages are put into the dead letters when the actor stops. Make sure you call
super.postStop if you override it.</p>
</div>
<div class="section" id="forwarding-terminated-messages">
<h2>Forwarding Terminated messages</h2>
<p>Forwarding <tt class="docutils literal"><span class="pre">Terminated</span></tt> messages is no longer supported. Instead, if you forward
<tt class="docutils literal"><span class="pre">Terminated</span></tt> you should send the information in your own message.</p>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">context</span><span class="o">.</span><span class="n">watch</span><span class="o">(</span><span class="n">subject</span><span class="o">)</span>

<span class="k">def</span> <span class="n">receive</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">case</span> <span class="n">t</span> <span class="k">@</span> <span class="nc">Terminated</span> <span class="k">=&gt;</span> <span class="n">someone</span> <span class="n">forward</span> <span class="n">t</span>
<span class="o">}</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">case</span> <span class="k">class</span> <span class="nc">MyTerminated</span><span class="o">(</span><span class="n">subject</span><span class="k">:</span> <span class="kt">ActorRef</span><span class="o">)</span>

<span class="n">context</span><span class="o">.</span><span class="n">watch</span><span class="o">(</span><span class="n">subject</span><span class="o">)</span>

<span class="k">def</span> <span class="n">receive</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">case</span> <span class="nc">Terminated</span><span class="o">(</span><span class="n">s</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="n">someone</span> <span class="n">forward</span> <span class="nc">MyTerminated</span><span class="o">(</span><span class="n">s</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-routers-and-resizers">
<h2>Custom Routers and Resizers</h2>
<p>The API of <tt class="docutils literal"><span class="pre">RouterConfig</span></tt>, <tt class="docutils literal"><span class="pre">RouteeProvider</span></tt> and <tt class="docutils literal"><span class="pre">Resizer</span></tt> has been
cleaned up. If you use these to build your own router functionality the
compiler will tell you if you need to make adjustments.</p>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyRouter</span><span class="o">(</span><span class="n">target</span><span class="k">:</span> <span class="kt">ActorRef</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">RouterConfig</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">createRoute</span><span class="o">(</span><span class="n">p</span><span class="k">:</span> <span class="kt">Props</span><span class="o">,</span> <span class="n">prov</span><span class="k">:</span> <span class="kt">RouteeProvider</span><span class="o">)</span><span class="k">:</span> <span class="kt">Route</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">prov</span><span class="o">.</span><span class="n">createAndRegisterRoutees</span><span class="o">(</span><span class="n">p</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyRouter</span><span class="o">(</span><span class="n">target</span><span class="k">:</span> <span class="kt">ActorRef</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">RouterConfig</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="n">createRoute</span><span class="o">(</span><span class="n">provider</span><span class="k">:</span> <span class="kt">RouteeProvider</span><span class="o">)</span><span class="k">:</span> <span class="kt">Route</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">provider</span><span class="o">.</span><span class="n">createRoutees</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
</pre></div>
</div>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">def</span> <span class="n">resize</span><span class="o">(</span><span class="n">props</span><span class="k">:</span> <span class="kt">Props</span><span class="o">,</span> <span class="n">routeeProvider</span><span class="k">:</span> <span class="kt">RouteeProvider</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">currentRoutees</span> <span class="k">=</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">routees</span>
  <span class="k">val</span> <span class="n">requestedCapacity</span> <span class="k">=</span> <span class="n">capacity</span><span class="o">(</span><span class="n">currentRoutees</span><span class="o">)</span>

  <span class="k">if</span> <span class="o">(</span><span class="n">requestedCapacity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">newRoutees</span> <span class="k">=</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">createRoutees</span><span class="o">(</span><span class="n">props</span><span class="o">,</span> <span class="n">requestedCapacity</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">)</span>
    <span class="n">routeeProvider</span><span class="o">.</span><span class="n">registerRoutees</span><span class="o">(</span><span class="n">newRoutees</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">requestedCapacity</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">val</span> <span class="o">(</span><span class="n">keep</span><span class="o">,</span> <span class="n">abandon</span><span class="o">)</span> <span class="k">=</span> <span class="n">currentRoutees</span><span class="o">.</span><span class="n">splitAt</span><span class="o">(</span><span class="n">currentRoutees</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span>
      <span class="n">requestedCapacity</span><span class="o">)</span>
    <span class="n">routeeProvider</span><span class="o">.</span><span class="n">unregisterRoutees</span><span class="o">(</span><span class="n">abandon</span><span class="o">)</span>
    <span class="n">delayedStop</span><span class="o">(</span><span class="n">routeeProvider</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">scheduler</span><span class="o">,</span> <span class="n">abandon</span><span class="o">)(</span>
      <span class="n">routeeProvider</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">)</span>
  <span class="o">}</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">def</span> <span class="n">resize</span><span class="o">(</span><span class="n">routeeProvider</span><span class="k">:</span> <span class="kt">RouteeProvider</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">currentRoutees</span> <span class="k">=</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">routees</span>
  <span class="k">val</span> <span class="n">requestedCapacity</span> <span class="k">=</span> <span class="n">capacity</span><span class="o">(</span><span class="n">currentRoutees</span><span class="o">)</span>

  <span class="k">if</span> <span class="o">(</span><span class="n">requestedCapacity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">createRoutees</span><span class="o">(</span><span class="n">requestedCapacity</span><span class="o">)</span>
  <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">requestedCapacity</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="n">routeeProvider</span><span class="o">.</span><span class="n">removeRoutees</span><span class="o">(</span>
    <span class="o">-</span><span class="n">requestedCapacity</span><span class="o">,</span> <span class="n">stopDelay</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="duration-and-timeout">
<h2>Duration and Timeout</h2>
<p>The <tt class="xref py py-class docutils literal"><span class="pre">akka.util.Duration</span></tt> class has been moved into the Scala library under
the <tt class="docutils literal"><span class="pre">scala.concurrent.duration</span></tt> package. Several changes have been made to tighten
up the duration and timeout API.</p>
<p><tt class="xref py py-class docutils literal"><span class="pre">FiniteDuration</span></tt> is now used more consistently throught the API.
The advantage is that if you try to pass a possibly non-finite duration where
it does not belong you’ll get compile errors instead of runtime exceptions.</p>
<p>The main source incompatibility is that you may have to change the declared
type of fields from <tt class="docutils literal"><span class="pre">Duration</span></tt> to <tt class="docutils literal"><span class="pre">FiniteDuration</span></tt> (factory methods already
return the more precise type wherever possible).</p>
<p>Another change is that <tt class="docutils literal"><span class="pre">Duration.parse</span></tt> was not accepted by the Scala library
maintainers; use <tt class="docutils literal"><span class="pre">Duration.create</span></tt> instead.</p>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">final</span> <span class="nc">Duration</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Duration</span><span class="o">.</span><span class="n">parse</span><span class="o">(</span><span class="s">&quot;1 second&quot;</span><span class="o">);</span>
<span class="k">final</span> <span class="nc">Timeout</span> <span class="n">t</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Timeout</span><span class="o">(</span><span class="n">d</span><span class="o">);</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">final</span> <span class="nc">FiniteDuration</span> <span class="n">d</span> <span class="k">=</span> <span class="nc">Duration</span><span class="o">.</span><span class="n">create</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="nc">SECONDS</span><span class="o">);</span>
<span class="k">final</span> <span class="nc">Timeout</span> <span class="n">t</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Timeout</span><span class="o">(</span><span class="n">d</span><span class="o">);</span> <span class="c1">// always required finite duration, now enforced</span>
</pre></div>
</div>
</div>
<div class="section" id="package-name-changes-in-remoting">
<h2>Package Name Changes in Remoting</h2>
<p>The package name of all classes in the <tt class="docutils literal"><span class="pre">akka-remote.jar</span></tt> artifact now starts with <tt class="docutils literal"><span class="pre">akka.remote</span></tt>.
This has been done to enable OSGi bundles that don't have conflicting package names.</p>
<p>Change the following import statements. Please note that serializers are often referenced from
configuration files.</p>
<p>Search -&gt; Replace with:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">akka</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="nc">RemoteRouterConfig</span> <span class="o">-&gt;</span>
<span class="n">akka</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="nc">RemoteRouterConfig</span>

<span class="n">akka</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="nc">ProtobufSerializer</span> <span class="o">-&gt;</span>
<span class="n">akka</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="nc">ProtobufSerializer</span>

<span class="n">akka</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="nc">DaemonMsgCreateSerializer</span> <span class="o">-&gt;</span>
<span class="n">akka</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">serialization</span><span class="o">.</span><span class="nc">DaemonMsgCreateSerializer</span>
</pre></div>
</div>
</div>
<div class="section" id="package-name-changes-in-durable-mailboxes">
<h2>Package Name Changes in Durable Mailboxes</h2>
<p>The package names of all classes in the <tt class="docutils literal"><span class="pre">akka-file-mailbox.jar</span></tt> artifact now start with <tt class="docutils literal"><span class="pre">akka.actor.mailbox.filebased</span></tt>.
This has been done to enable OSGi bundles that don't have conflicting package names.</p>
<p>Change the following import statements. Please note that the <tt class="docutils literal"><span class="pre">FileBasedMailboxType</span></tt> is often referenced from configuration.</p>
<p>Search -&gt; Replace with:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">FileBasedMailboxType</span> <span class="o">-&gt;</span>
<span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="n">filebased</span><span class="o">.</span><span class="nc">FileBasedMailboxType</span>

<span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">FileBasedMailboxSettings</span> <span class="o">-&gt;</span>
<span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="n">filebased</span><span class="o">.</span><span class="nc">FileBasedMailboxSettings</span>

<span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="nc">FileBasedMessageQueue</span> <span class="o">-&gt;</span>
<span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="n">filebased</span><span class="o">.</span><span class="nc">FileBasedMessageQueue</span>

<span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="n">filequeue</span><span class="o">.*</span> <span class="o">-&gt;</span>
<span class="n">akka</span><span class="o">.</span><span class="n">actor</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="n">filebased</span><span class="o">.</span><span class="n">filequeue</span><span class="o">.*</span>
</pre></div>
</div>
</div>
<div class="section" id="actor-receive-timeout">
<h2>Actor Receive Timeout</h2>
<p>The API for setting and querying the receive timeout has been made more
consistent in always taking and returning a <tt class="docutils literal"><span class="pre">Duration</span></tt>; the wrapping in
<tt class="docutils literal"><span class="pre">Option</span></tt> has been removed.</p>
<p>(Samples for Java, Scala sources are affected in exactly the same way.)</p>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">getContext</span><span class="o">().</span><span class="n">setReceiveTimeout</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="n">create</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="nc">SECONDS</span><span class="o">));</span>
<span class="k">final</span> <span class="nc">Option</span><span class="o">&lt;</span><span class="nc">Duration</span><span class="o">&gt;</span> <span class="n">timeout</span> <span class="k">=</span> <span class="n">getContext</span><span class="o">().</span><span class="n">receiveTimeout</span><span class="o">();</span>
<span class="k">final</span> <span class="n">isSet</span> <span class="k">=</span> <span class="n">timeout</span><span class="o">.</span><span class="n">isDefined</span><span class="o">();</span>
<span class="n">resetReceiveTimeout</span><span class="o">();</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="n">getContext</span><span class="o">().</span><span class="n">setReceiveTimeout</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="n">create</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="nc">SECONDS</span><span class="o">));</span>
<span class="k">final</span> <span class="nc">Duration</span> <span class="n">timeout</span> <span class="k">=</span> <span class="n">getContext</span><span class="o">().</span><span class="n">receiveTimeout</span><span class="o">();</span>
<span class="k">final</span> <span class="n">isSet</span> <span class="k">=</span> <span class="n">timeout</span><span class="o">.</span><span class="n">isFinite</span><span class="o">();</span>
<span class="n">getContext</span><span class="o">().</span><span class="n">setReceiveTimeout</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="nc">Undefined</span><span class="o">());</span>
</pre></div>
</div>
</div>
<div class="section" id="consistenthash">
<h2>ConsistentHash</h2>
<p><tt class="docutils literal"><span class="pre">akka.routing.ConsistentHash</span></tt> has been changed into an immutable data structure.</p>
<p>v2.0:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">val</span> <span class="n">consistentHash</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">ConsistentHash</span><span class="o">(</span><span class="nc">Seq</span><span class="o">(</span><span class="n">a1</span><span class="o">,</span> <span class="n">a2</span><span class="o">,</span> <span class="n">a3</span><span class="o">),</span> <span class="n">replicas</span> <span class="k">=</span> <span class="mi">10</span><span class="o">)</span>
<span class="n">consistentHash</span> <span class="o">+=</span> <span class="n">a4</span>
<span class="k">val</span> <span class="n">a</span> <span class="k">=</span> <span class="n">consistentHash</span><span class="o">.</span><span class="n">nodeFor</span><span class="o">(</span><span class="n">data</span><span class="o">)</span>
</pre></div>
</div>
<p>v2.1:</p>
<div class="highlight-scala"><div class="highlight"><pre><span class="k">var</span> <span class="n">consistentHash</span> <span class="k">=</span> <span class="nc">ConsistentHash</span><span class="o">(</span><span class="nc">Seq</span><span class="o">(</span><span class="n">a1</span><span class="o">,</span> <span class="n">a2</span><span class="o">,</span> <span class="n">a3</span><span class="o">),</span> <span class="n">replicas</span> <span class="k">=</span> <span class="mi">10</span><span class="o">)</span>
<span class="n">consistentHash</span> <span class="k">=</span> <span class="n">consistentHash</span> <span class="o">:+</span> <span class="n">a4</span>
<span class="k">val</span> <span class="n">a</span> <span class="k">=</span> <span class="n">consistentHash</span><span class="o">.</span><span class="n">nodeFor</span><span class="o">(</span><span class="n">data</span><span class="o">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <div class="span3"><p class="contents-title">Contents</p>
              <div id="scroller-anchor">
                <div id="scroller">
                  <div id="toc"></div>
                </div>
              </div></div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
  <div class="container">
    <ul>
      <li><h5>Akka</h5></li>
      <li><a href="http://akka.io/docs">Documentation</a></li>
      <li><a href="http://akka.io/faq">FAQ</a></li>
      <li><a href="http://typesafe.com/stack/downloads/akka">Downloads</a></li>
      <li><a href="http://akka.io/news">News</a></li>
      <li><a href="http://letitcrash.com">Blog</a></li>
    </ul>
    <ul>
      <li><h5>Contribute</h5></li>
      <li><a href="http://akka.io/community">Community Projects</a></li>
      <li><a href="http://github.com/akka/akka">Source Code</a></li>
      <li><a href="http://groups.google.com/group/akka-user">Mailing List</a></li>      
      <li><a href="http://doc.akka.io/docs/akka/current/project/issue-tracking.html">Report a Bug</a></li>      
    </ul>
    <ul>
      <li><h5>Company</h5></li>
      <li><a href="http://typesafe.com/products/typesafe-subscription">Commercial Support</a></li>
      <li><a href="http://akka.io/team">Team</a></li>
      <li><a href="mailto:info@typesafe.com">Contact</a></li>
    </ul>
    <ul>
      <li><img src="../_static/watermark.png" align="center"/></li>
    </ul>
  </div>
  <div class="container copyright">
    <p style="float: left;">
      © 2012 <a href="http://typesafe.com/">Typesafe Inc.</a> <span class="license">Akka is Open Source and available under the Apache 2 License.</span>
    </p>
    <p style="float: right; font-size: 12px;">
      Last updated: Mar 15, 2013
    </p>          
  </div>
</div>
<script type="text/javascript">
  $('#toc').toc();
</script>
  

  </body>
</html>